!function(){var a;(a=jQuery).fn.rtsb_wishlist=function(){a(document).off("click",".rtsb-wishlist-add").off("click",".rtsb-wishlist-remove").on("click",".rtsb-wishlist-add",function(d){d.preventDefault();var b=a(this),c=b.data("product_id");c&&a.ajax({type:"POST",headers:{"X-WP-Nonce":rtsbWishlistParams.rest_nonce},url:rtsbWishlistParams.resturl+"rtsb/v1/wishlist/add_to_list/",data:{product_id:c},beforeSend:function(c){b.rtsbBlock(),a(document).trigger("rtsb.wishlist.adding",[b])},success:function(c){var d,e=rtsbWishlistParams.notice.added;rtsbWishlistParams.notice.browse&&(e=' <a href="'+rtsbWishlistParams.pageUrl+'">'+rtsbWishlistParams.notice.browse+"</a>"),c.success?(a(document).trigger("rtsb.wishlist.added",[c,b]),d=rtsbWishlistParams.notice.added,rtsbToastr.success(e,d)):(a(document).trigger("rtsb.wishlist.adding_error",[c,b]),c.data&&"exist"===c.data.action?(d=rtsbWishlistParams.notice.exist,rtsbToastr.success(e,d)):rtsbToastr.error(c.message)),b.rtsbUnblock()},error:function(c){a(document).trigger("rtsb.wishlist.adding_error",[c,b]),b.rtsbUnblock(),"authentication_error"===c.responseJSON.code?rtsbToastr.error(c.responseJSON.message):rtsbToastr.error(rtsbWishlistParams.notice.error)},complete:function(c){a(document).trigger("rtsb.wishlist.adding_completed",[c,b])}})}).on("click",".rtsb-wishlist-remove",function(d){d.preventDefault();var b=a(this),c=b.data("product_id");c&&a.ajax({type:"POST",headers:{"X-WP-Nonce":rtsbWishlistParams.rest_nonce},url:rtsbWishlistParams.resturl+"rtsb/v1/wishlist/remove_from_list/",data:{product_id:c},beforeSend:function(c){b.rtsbBlock(),a(document).trigger("rtsb.wishlist.removing",[b])},success:function(c){c.success?(a(document).trigger("rtsb.wishlist.removed",[c,b]),rtsbToastr.success(rtsbWishlistParams.notice.removed)):(a(document).trigger("rtsb.wishlist.removing_error",[c,b]),rtsbToastr.error(c.message)),b.rtsbUnblock()},error:function(c){a(document).trigger("rtsb.wishlist.removing_error",[c,b]),b.rtsbUnblock(),rtsbToastr.error(rtsbWishlistParams.notice.error)},complete:function(c){a(document).trigger("rtsb.wishlist.removing_completed",[c,b])}})})},a(document).on("rtsb.wishlist.added",function(d,c,b){b.removeClass("rtsb-wishlist-add").addClass("rtsb-wishlist-remove"),a(".rtsb-wishlist-counter").text(c.data.item_count),b.attr("original-title",rtsbWishlistParams.notice.remove_wishlist),a(b).find(".button-text").text(rtsbWishlistParams.notice.remove_wishlist)}).on("rtsb.wishlist.removed",function(d,c,b){b.removeClass("rtsb-wishlist-remove").addClass("rtsb-wishlist-add").parents('tr.rtsb-wl-product[data-product_id="'+c.data.product_id+'"]').slideUp("slow",function(){a(this).remove()}),a(".rtsb-wishlist-counter").text(c.data.item_count),b.attr("original-title",rtsbWishlistParams.notice.add_to_wishlist),a(b).find(".button-text").text(rtsbWishlistParams.notice.button_text)}),a(function(){a.fn.rtsb_wishlist()})}()