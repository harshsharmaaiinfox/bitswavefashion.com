!function(){var a;(a=jQuery).fn.rtsb_compare=function(){a(document).off("click",".rtsb-compare-add").off("click",".rtsb-compare-remove").on("click",".rtsb-compare-add",function(d){d.preventDefault();var b=a(this),c=b.data("product_id");c&&a.ajax({type:"POST",url:rtsbCompareParams.resturl+"rtsb/v1/compare/add_to_list/",data:{product_id:c},beforeSend:function(c){b.rtsbBlock(),a(document).trigger("rtsb.compare.adding",[b]),c.setRequestHeader("X-WP-Nonce",rtsbCompareParams.rest_nonce)},success:function(c){if(c.success){a(document).trigger("rtsb.compare.added",[c,b]);var d,e=rtsbCompareParams.notice.added;rtsbCompareParams.notice.browse&&rtsbCompareParams.notice.browse&&(e=' <a href="'+rtsbCompareParams.pageUrl+'">'+rtsbCompareParams.notice.browse+"</a>",d=rtsbCompareParams.notice.added),rtsbToastr.success(e,d)}else a(document).trigger("rtsb.compare.adding_error",[c,b]),rtsbToastr.error(c.message);b.rtsbUnblock()},error:function(c){a(document).trigger("rtsb.compare.adding_error",[c,b]),b.rtsbUnblock(),rtsbToastr.error(rtsbCompareParams.notice.error)},complete:function(c){a(document).trigger("rtsb.compare.adding_completed",[c,b])}})}).on("click",".rtsb-compare-remove",function(d){d.preventDefault();var b=a(this),c=b.data("product_id");c&&a.ajax({type:"POST",url:rtsbCompareParams.resturl+"rtsb/v1/compare/remove_from_list/",data:{product_id:c},beforeSend:function(c){b.rtsbBlock(),a(document).trigger("rtsb.compare.removing",[b]),c.setRequestHeader("X-WP-Nonce",rtsbCompareParams.rest_nonce)},success:function(c){c.success?(a(document).trigger("rtsb.compare.removed",[c,b]),rtsbToastr.success(rtsbCompareParams.notice.removed)):(a(document).trigger("rtsb.compare.removing_error",[c,b]),rtsbToastr.error(c.message)),b.rtsbUnblock()},error:function(c){a(document).trigger("rtsb.compare.removing_error",[c,b]),b.rtsbUnblock(),rtsbToastr.error(rtsbCompareParams.notice.error)},complete:function(c){a(document).trigger("rtsb.compare.removing_completed",[c,b])}})})},a(document).ready(function(){a.fn.rtsb_compare(),a(document).on("rtsb.compare.added",function(d,b,c){c.removeClass("rtsb-compare-add").addClass("rtsb-compare-remove"),a(".rtsb-compare-list").html(b.data.list_html),a(".rtsb-compare-counter").text(b.data.item_count),a(c).find(".button-text").text(rtsbCompareParams.notice.ajax_remove_compare)}).on("rtsb.compare.removed",function(d,b,c){c.removeClass("rtsb-compare-remove").addClass("rtsb-compare-add"),a(".rtsb-compare-list").html(b.data.list_html),a(".rtsb-compare-counter").text(b.data.item_count),a(c).find(".button-text").text(rtsbCompareParams.notice.ajax_button_text)})})}()