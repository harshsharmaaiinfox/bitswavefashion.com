!function(){var t;(t=jQuery).fn.rtsb_wishlist=function(){t(document).off("click",".rtsb-wishlist-add").off("click",".rtsb-wishlist-remove").on("click",".rtsb-wishlist-add",(function(s){s.preventDefault();var r=t(this),i=r.data("product_id");i&&t.ajax({type:"POST",headers:{"X-WP-Nonce":rtsbWishlistParams.rest_nonce},url:rtsbWishlistParams.resturl+"rtsb/v1/wishlist/add_to_list/",data:{product_id:i},beforeSend:function(s){r.rtsbBlock(),t(document).trigger("rtsb.wishlist.adding",[r])},success:function(s){var i,e=rtsbWishlistParams.notice.added;rtsbWishlistParams.notice.browse&&(e=' <a href="'+rtsbWishlistParams.pageUrl+'">'+rtsbWishlistParams.notice.browse+"</a>"),s.success?(t(document).trigger("rtsb.wishlist.added",[s,r]),i=rtsbWishlistParams.notice.added,rtsbToastr.success(e,i)):(t(document).trigger("rtsb.wishlist.adding_error",[s,r]),s.data&&"exist"===s.data.action?(i=rtsbWishlistParams.notice.exist,rtsbToastr.success(e,i)):rtsbToastr.error(s.message)),r.rtsbUnblock()},error:function(s){t(document).trigger("rtsb.wishlist.adding_error",[s,r]),r.rtsbUnblock(),"authentication_error"===s.responseJSON.code?rtsbToastr.error(s.responseJSON.message):rtsbToastr.error(rtsbWishlistParams.notice.error)},complete:function(s){t(document).trigger("rtsb.wishlist.adding_completed",[s,r])}})})).on("click",".rtsb-wishlist-remove",(function(s){s.preventDefault();var r=t(this),i=r.data("product_id");i&&t.ajax({type:"POST",headers:{"X-WP-Nonce":rtsbWishlistParams.rest_nonce},url:rtsbWishlistParams.resturl+"rtsb/v1/wishlist/remove_from_list/",data:{product_id:i},beforeSend:function(s){r.rtsbBlock(),t(document).trigger("rtsb.wishlist.removing",[r])},success:function(s){s.success?(t(document).trigger("rtsb.wishlist.removed",[s,r]),rtsbToastr.success(rtsbWishlistParams.notice.removed)):(t(document).trigger("rtsb.wishlist.removing_error",[s,r]),rtsbToastr.error(s.message)),r.rtsbUnblock()},error:function(s){t(document).trigger("rtsb.wishlist.removing_error",[s,r]),r.rtsbUnblock(),rtsbToastr.error(rtsbWishlistParams.notice.error)},complete:function(s){t(document).trigger("rtsb.wishlist.removing_completed",[s,r])}})}))},t(document).on("rtsb.wishlist.added",(function(s,r,i){i.removeClass("rtsb-wishlist-add").addClass("rtsb-wishlist-remove"),t(".rtsb-wishlist-counter").text(r.data.item_count),i.attr("original-title",rtsbWishlistParams.notice.remove_wishlist),t(i).find(".button-text").text(rtsbWishlistParams.notice.remove_wishlist)})).on("rtsb.wishlist.removed",(function(s,r,i){i.removeClass("rtsb-wishlist-remove").addClass("rtsb-wishlist-add").parents('tr.rtsb-wl-product[data-product_id="'+r.data.product_id+'"]').slideUp("slow",(function(){t(this).remove()})),t(".rtsb-wishlist-counter").text(r.data.item_count),i.attr("original-title",rtsbWishlistParams.notice.add_to_wishlist),t(i).find(".button-text").text(rtsbWishlistParams.notice.button_text)})),t((function(){t.fn.rtsb_wishlist()}))}();