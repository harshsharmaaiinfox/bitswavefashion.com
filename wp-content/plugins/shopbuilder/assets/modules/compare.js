!function(){var r;(r=jQuery).fn.rtsb_compare=function(){r(document).off("click",".rtsb-compare-add").off("click",".rtsb-compare-remove").on("click",".rtsb-compare-add",(function(e){e.preventDefault();var t=r(this),o=t.data("product_id");o&&r.ajax({type:"POST",url:rtsbCompareParams.resturl+"rtsb/v1/compare/add_to_list/",data:{product_id:o},beforeSend:function(e){t.rtsbBlock(),r(document).trigger("rtsb.compare.adding",[t]),e.setRequestHeader("X-WP-Nonce",rtsbCompareParams.rest_nonce)},success:function(e){if(e.success){r(document).trigger("rtsb.compare.added",[e,t]);var o,a=rtsbCompareParams.notice.added;rtsbCompareParams.notice.browse&&rtsbCompareParams.notice.browse&&(a=' <a href="'+rtsbCompareParams.pageUrl+'">'+rtsbCompareParams.notice.browse+"</a>",o=rtsbCompareParams.notice.added),rtsbToastr.success(a,o)}else r(document).trigger("rtsb.compare.adding_error",[e,t]),rtsbToastr.error(e.message);t.rtsbUnblock()},error:function(e){r(document).trigger("rtsb.compare.adding_error",[e,t]),t.rtsbUnblock(),rtsbToastr.error(rtsbCompareParams.notice.error)},complete:function(e){r(document).trigger("rtsb.compare.adding_completed",[e,t])}})})).on("click",".rtsb-compare-remove",(function(e){e.preventDefault();var t=r(this),o=t.data("product_id");o&&r.ajax({type:"POST",url:rtsbCompareParams.resturl+"rtsb/v1/compare/remove_from_list/",data:{product_id:o},beforeSend:function(e){t.rtsbBlock(),r(document).trigger("rtsb.compare.removing",[t]),e.setRequestHeader("X-WP-Nonce",rtsbCompareParams.rest_nonce)},success:function(e){e.success?(r(document).trigger("rtsb.compare.removed",[e,t]),rtsbToastr.success(rtsbCompareParams.notice.removed)):(r(document).trigger("rtsb.compare.removing_error",[e,t]),rtsbToastr.error(e.message)),t.rtsbUnblock()},error:function(e){r(document).trigger("rtsb.compare.removing_error",[e,t]),t.rtsbUnblock(),rtsbToastr.error(rtsbCompareParams.notice.error)},complete:function(e){r(document).trigger("rtsb.compare.removing_completed",[e,t])}})}))},r(document).ready((function(){r.fn.rtsb_compare(),r(document).on("rtsb.compare.added",(function(e,t,o){o.removeClass("rtsb-compare-add").addClass("rtsb-compare-remove"),r(".rtsb-compare-list").html(t.data.list_html),r(".rtsb-compare-counter").text(t.data.item_count),r(o).find(".button-text").text(rtsbCompareParams.notice.ajax_remove_compare)})).on("rtsb.compare.removed",(function(e,t,o){o.removeClass("rtsb-compare-remove").addClass("rtsb-compare-add"),r(".rtsb-compare-list").html(t.data.list_html),r(".rtsb-compare-counter").text(t.data.item_count),r(o).find(".button-text").text(rtsbCompareParams.notice.ajax_button_text)}))}))}();